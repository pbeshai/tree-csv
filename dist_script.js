var csvData;
var rootNode;
var idKey = 'Source';
var parentKey = 'Target';
var colorKey = 'Emotion';
var specialKey = 'Is_Influencer';
var specialSizeFactor = 1.6;
var colorScale = d3.scaleOrdinal();
var highlightNode = null;

var queryParams = window.location.search
  .substring(1)
  .split('&')
  .filter(function (d) { return d !== ''; })
  .reduce(function (params, param) {
    var entry = param.split('=');
    params[entry[0]] = entry[1];
    return params;
  }, {});

var width = queryParams.width ? +queryParams.width : 800;
var height = queryParams.height ? +queryParams.height : 800;

// padding around the chart where axes will go
var padding = {
  top: 20,
  right: 20,
  bottom: 20,
  left: 20,
};

// inner chart dimensions, where the dots are plotted
var plotAreaWidth = width - padding.left - padding.right;
var plotAreaHeight = height - padding.top - padding.bottom;

// radius of points in the scatterplot
var pointRadius = 5;

// select the root container where the chart will be added
var rootContainer = d3.select('#root');

function render() {
  renderControls();
  renderLegend();
  renderTree();
  renderHighlight();
}

function renderControls() {
  console.log('render controls');
  d3.select('#read-csv-btn').on('click', function () {
    treeFromCsvTextArea();
    render();
  });
}

function isSpecial(d) {
  return !!d[specialKey] && d[specialKey] !== '0';
}

function renderHighlight() {
  var highlightContainer = rootContainer
    .select('.highlight-container')
    .empty()
    ? rootContainer
        .select('.vis-container')
        .append('div')
        .attr('class', 'highlight-container')
    : rootContainer.select('.highlight-container');

  if (!highlightNode) {
    highlightContainer.style('display', 'none');
    return;
  }
  var data = highlightNode.data;
  var highlightRowHtml = Object.keys(data)
    .map(
      function (key) { return ("<tr><td class='key'>" + key + "</td><td class='value'>" + (data[key]) + (key ===
        colorKey
          ? ("<span class='color-swatch' style='background: " + (colorScale(
              data[key]
            )) + "'></span>")
          : '') + "</td></tr>"); }
    )
    .join('');

  highlightContainer
    .style('display', '')
    .html(
      ("<table class='node-table'><tbody>" + highlightRowHtml + "</tbody></table>")
    );

  var ref = highlightContainer.node().getBoundingClientRect();
  var hWidth = ref.width;
  var hHeight = ref.height;

  var x = highlightNode.x;
  var y = highlightNode.y;
  x += padding.left;
  y += padding.top;
  var hMargin = 5;

  if (y + hHeight > height) {
    y -= hHeight;
    y -= hMargin;
  } else {
    y += hMargin;
  }

  if (x + hWidth > width) {
    x -= hWidth;
    x -= hMargin;
  } else {
    x += hMargin;
  }

  console.log(highlightNode, x, y);
  highlightContainer.style('transform', ("translate(" + x + "px, " + y + "px)"));
}

function renderLegend() {
  /** Legend */
  var legendContainer = rootContainer.select('.legend').empty()
    ? rootContainer.append('div').attr('class', 'legend')
    : rootContainer.select('.legend');

  var legendBinding = legendContainer
    .selectAll('.legend-item')
    .data(colorScale.domain());
  legendBinding.exit().remove();
  var legendEntering = legendBinding
    .enter()
    .append('span')
    .attr('class', 'legend-item')
    .html(' tessssst');
  legendEntering
    .merge(legendBinding)
    .html(
      function (d) { return ("<span class='legend-swatch' style='background: " + (colorScale(
          d
        )) + "'></span><span class='legend-item-label'>" + d + "</span> "); }
    );
}

function renderTree() {
  console.log('render svg with rootNode', rootNode);
  // rootContainer.select('svg').remove();
  var nodes = rootNode ? rootNode.descendants() : [];
  var links = rootNode ? rootNode.links() : [];
  console.log('render svg with nodes', nodes);
  console.log('render svg with links', links);

  // initialize main SVG
  var svg = rootContainer.select('svg').empty()
    ? rootContainer
        .select('.vis-container')
        .append('svg')
        .attr('width', width)
        .attr('height', height)
    : rootContainer.select('svg');

  // the main <g> where all the chart content goes inside
  var g = svg.select('.root-g').empty()
    ? svg
        .append('g')
        .attr('class', 'root-g')
        .attr(
          'transform',
          'translate(' + padding.left + ' ' + padding.top + ')'
        )
    : svg.select('.root-g');

  var gLinks = g.select('.links').empty()
    ? g.append('g').attr('class', 'links')
    : g.select('.links');
  var gNodes = g.select('.nodes').empty()
    ? g.append('g').attr('class', 'nodes')
    : g.select('.nodes');

  // const highlightLabel = g.select('.highlight-label').empty()
  //   ? g
  //       .append('text')
  //       .attr('class', 'highlight-label')
  //       .attr('text-anchor', 'middle')
  //       .attr('dy', pointRadius + 18)
  //       .style('font-weight', '600')
  //       .style('pointer-events', 'none')
  //   : g.select('.highlight-label');

  // render nodes
  var nodesBinding = gNodes.selectAll('.node').data(nodes, function (d) { return d[idKey]; });
  nodesBinding.exit().remove();
  var nodesEnter = nodesBinding
    .enter()
    .append('circle')
    .attr('class', 'node')
    .attr('r', pointRadius)
    .attr('transform', function (d) { return ("translate(" + (d.x) + " " + (d.y) + ")"); })
    .on('mouseenter', function(d) {
      // highlightLabel
      //   .attr('transform', `translate(${d.x} ${d.y})`)
      //   .text(JSON.stringify(d.data));
      highlightNode = d;
      renderHighlight();
      d3.select(this).classed('highlighted', true);
    })
    .on('mouseleave', function() {
      // highlightLabel.text('');
      highlightNode = null;
      renderHighlight();
      d3.select(this).classed('highlighted', false);
    });

  nodesEnter
    .merge(nodesBinding)
    .classed('special', function (d) { return isSpecial(d.data); })
    .attr(
      'r',
      function (d) { return (isSpecial(d.data) ? specialSizeFactor * pointRadius : pointRadius); }
    )
    .attr('transform', function (d) { return ("translate(" + (d.x) + " " + (d.y) + ")"); })
    .style('fill', function (d) { return colorScale(d.data[colorKey]); });

  // render links
  var linksBinding = gLinks
    .selectAll('.link')
    .data(links, function (d) { return ((d.source[idKey]) + "--" + (d.target[idKey])); });
  linksBinding.exit().remove();

  var linksEnter = linksBinding
    .enter()
    .append('line')
    .attr('class', 'link')
    .attr('x1', function (d) { return d.source.x; })
    .attr('y1', function (d) { return d.source.y; })
    .attr('x2', function (d) { return d.target.x; })
    .attr('y2', function (d) { return d.target.y; });

  linksEnter
    .merge(linksBinding)
    .attr('x1', function (d) { return d.source.x; })
    .attr('y1', function (d) { return d.source.y; })
    .attr('x2', function (d) { return d.target.x; })
    .attr('y2', function (d) { return d.target.y; })
    .style('stroke', function (d) { return colorScale(d.target.data[colorKey]); });
}

function treeFromCsvTextArea() {
  var text = d3.select('#csv-text-input').property('value');
  csvData = d3.csvParse(text);

  try {
    var stratifier = d3
      .stratify()
      .id(function (d) { return d[idKey]; })
      .parentId(function (d) { return d[parentKey]; });
    rootNode = stratifier(csvData);
  } catch (e) {
    alert('Error occurred making tree: ' + e);
  }

  // run tree layout
  var tree = d3.tree().size([plotAreaWidth, plotAreaHeight]);
  tree(rootNode);

  console.log('got csvData =', csvData);
  console.log('got rootNode =', rootNode);
  console.log(idKey);

  // update the column selects
  d3
    .select('#id-key-select')
    .on('change', function() {
      idKey = this.value;
      treeFromCsvTextArea();
      render();
    })
    .selectAll('option')
    .data(csvData.columns)
    .enter()
    .append('option')
    .property('value', function (d) { return d; })
    .text(function (d) { return d; });
  d3.select('#id-key-select').property('value', idKey);

  d3
    .select('#parent-key-select')
    .on('change', function() {
      parentKey = this.value;
      treeFromCsvTextArea();
      render();
    })
    .selectAll('option')
    .data(csvData.columns)
    .enter()
    .append('option')
    .property('value', function (d) { return d; })
    .text(function (d) { return d; });
  d3.select('#parent-key-select').property('value', parentKey);

  d3
    .select('#color-key-select')
    .on('change', function() {
      colorKey = this.value;
      treeFromCsvTextArea();
      render();
    })
    .selectAll('option')
    .data(csvData.columns)
    .enter()
    .append('option')
    .property('value', function (d) { return d; })
    .text(function (d) { return d; });
  d3.select('#color-key-select').property('value', colorKey);

  d3
    .select('#special-key-select')
    .on('change', function() {
      specialKey = this.value;
      treeFromCsvTextArea();
      render();
    })
    .selectAll('option')
    .data(csvData.columns)
    .enter()
    .append('option')
    .property('value', function (d) { return d; })
    .text(function (d) { return d; });
  d3.select('#special-key-select').property('value', specialKey);

  var colorDomain = rootNode
    .descendants()
    .map(function (d) { return d.data[colorKey]; })
    .filter(function (d, i, a) { return a.indexOf(d) === i; })
    .sort();
  colorScale = d3.scaleOrdinal(d3.schemeSet1).domain(colorDomain);
  console.log('colorDomain', colorDomain);
  console.log('colorScale', colorScale);
}

treeFromCsvTextArea();
render();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlzdF9zY3JpcHQuanMiLCJzb3VyY2VzIjpbInNjcmlwdC5qcy0xNTE5OTQ1OTY3MTA1Il0sInNvdXJjZXNDb250ZW50IjpbImxldCBjc3ZEYXRhO1xubGV0IHJvb3ROb2RlO1xubGV0IGlkS2V5ID0gJ1NvdXJjZSc7XG5sZXQgcGFyZW50S2V5ID0gJ1RhcmdldCc7XG5sZXQgY29sb3JLZXkgPSAnRW1vdGlvbic7XG5sZXQgc3BlY2lhbEtleSA9ICdJc19JbmZsdWVuY2VyJztcbmNvbnN0IHNwZWNpYWxTaXplRmFjdG9yID0gMS42O1xubGV0IGNvbG9yU2NhbGUgPSBkMy5zY2FsZU9yZGluYWwoKTtcbmxldCBoaWdobGlnaHROb2RlID0gbnVsbDtcblxuY29uc3QgcXVlcnlQYXJhbXMgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoXG4gIC5zdWJzdHJpbmcoMSlcbiAgLnNwbGl0KCcmJylcbiAgLmZpbHRlcihkID0+IGQgIT09ICcnKVxuICAucmVkdWNlKChwYXJhbXMsIHBhcmFtKSA9PiB7XG4gICAgY29uc3QgZW50cnkgPSBwYXJhbS5zcGxpdCgnPScpO1xuICAgIHBhcmFtc1tlbnRyeVswXV0gPSBlbnRyeVsxXTtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9LCB7fSk7XG5cbmNvbnN0IHdpZHRoID0gcXVlcnlQYXJhbXMud2lkdGggPyArcXVlcnlQYXJhbXMud2lkdGggOiA4MDA7XG5jb25zdCBoZWlnaHQgPSBxdWVyeVBhcmFtcy5oZWlnaHQgPyArcXVlcnlQYXJhbXMuaGVpZ2h0IDogODAwO1xuXG4vLyBwYWRkaW5nIGFyb3VuZCB0aGUgY2hhcnQgd2hlcmUgYXhlcyB3aWxsIGdvXG5jb25zdCBwYWRkaW5nID0ge1xuICB0b3A6IDIwLFxuICByaWdodDogMjAsXG4gIGJvdHRvbTogMjAsXG4gIGxlZnQ6IDIwLFxufTtcblxuLy8gaW5uZXIgY2hhcnQgZGltZW5zaW9ucywgd2hlcmUgdGhlIGRvdHMgYXJlIHBsb3R0ZWRcbmNvbnN0IHBsb3RBcmVhV2lkdGggPSB3aWR0aCAtIHBhZGRpbmcubGVmdCAtIHBhZGRpbmcucmlnaHQ7XG5jb25zdCBwbG90QXJlYUhlaWdodCA9IGhlaWdodCAtIHBhZGRpbmcudG9wIC0gcGFkZGluZy5ib3R0b207XG5cbi8vIHJhZGl1cyBvZiBwb2ludHMgaW4gdGhlIHNjYXR0ZXJwbG90XG5jb25zdCBwb2ludFJhZGl1cyA9IDU7XG5cbi8vIHNlbGVjdCB0aGUgcm9vdCBjb250YWluZXIgd2hlcmUgdGhlIGNoYXJ0IHdpbGwgYmUgYWRkZWRcbmNvbnN0IHJvb3RDb250YWluZXIgPSBkMy5zZWxlY3QoJyNyb290Jyk7XG5cbmZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgcmVuZGVyQ29udHJvbHMoKTtcbiAgcmVuZGVyTGVnZW5kKCk7XG4gIHJlbmRlclRyZWUoKTtcbiAgcmVuZGVySGlnaGxpZ2h0KCk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNvbnRyb2xzKCkge1xuICBjb25zb2xlLmxvZygncmVuZGVyIGNvbnRyb2xzJyk7XG4gIGQzLnNlbGVjdCgnI3JlYWQtY3N2LWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICB0cmVlRnJvbUNzdlRleHRBcmVhKCk7XG4gICAgcmVuZGVyKCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpc1NwZWNpYWwoZCkge1xuICByZXR1cm4gISFkW3NwZWNpYWxLZXldICYmIGRbc3BlY2lhbEtleV0gIT09ICcwJztcbn1cblxuZnVuY3Rpb24gcmVuZGVySGlnaGxpZ2h0KCkge1xuICBjb25zdCBoaWdobGlnaHRDb250YWluZXIgPSByb290Q29udGFpbmVyXG4gICAgLnNlbGVjdCgnLmhpZ2hsaWdodC1jb250YWluZXInKVxuICAgIC5lbXB0eSgpXG4gICAgPyByb290Q29udGFpbmVyXG4gICAgICAgIC5zZWxlY3QoJy52aXMtY29udGFpbmVyJylcbiAgICAgICAgLmFwcGVuZCgnZGl2JylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2hpZ2hsaWdodC1jb250YWluZXInKVxuICAgIDogcm9vdENvbnRhaW5lci5zZWxlY3QoJy5oaWdobGlnaHQtY29udGFpbmVyJyk7XG5cbiAgaWYgKCFoaWdobGlnaHROb2RlKSB7XG4gICAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBkYXRhIH0gPSBoaWdobGlnaHROb2RlO1xuICBjb25zdCBoaWdobGlnaHRSb3dIdG1sID0gT2JqZWN0LmtleXMoZGF0YSlcbiAgICAubWFwKFxuICAgICAga2V5ID0+XG4gICAgICAgIGA8dHI+PHRkIGNsYXNzPSdrZXknPiR7a2V5fTwvdGQ+PHRkIGNsYXNzPSd2YWx1ZSc+JHtkYXRhW2tleV19JHtrZXkgPT09XG4gICAgICAgIGNvbG9yS2V5XG4gICAgICAgICAgPyBgPHNwYW4gY2xhc3M9J2NvbG9yLXN3YXRjaCcgc3R5bGU9J2JhY2tncm91bmQ6ICR7Y29sb3JTY2FsZShcbiAgICAgICAgICAgICAgZGF0YVtrZXldXG4gICAgICAgICAgICApfSc+PC9zcGFuPmBcbiAgICAgICAgICA6ICcnfTwvdGQ+PC90cj5gXG4gICAgKVxuICAgIC5qb2luKCcnKTtcblxuICBoaWdobGlnaHRDb250YWluZXJcbiAgICAuc3R5bGUoJ2Rpc3BsYXknLCAnJylcbiAgICAuaHRtbChcbiAgICAgIGA8dGFibGUgY2xhc3M9J25vZGUtdGFibGUnPjx0Ym9keT4ke2hpZ2hsaWdodFJvd0h0bWx9PC90Ym9keT48L3RhYmxlPmBcbiAgICApO1xuXG4gIGNvbnN0IHtcbiAgICB3aWR0aDogaFdpZHRoLFxuICAgIGhlaWdodDogaEhlaWdodCxcbiAgfSA9IGhpZ2hsaWdodENvbnRhaW5lci5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgbGV0IHsgeCwgeSB9ID0gaGlnaGxpZ2h0Tm9kZTtcbiAgeCArPSBwYWRkaW5nLmxlZnQ7XG4gIHkgKz0gcGFkZGluZy50b3A7XG4gIGNvbnN0IGhNYXJnaW4gPSA1O1xuXG4gIGlmICh5ICsgaEhlaWdodCA+IGhlaWdodCkge1xuICAgIHkgLT0gaEhlaWdodDtcbiAgICB5IC09IGhNYXJnaW47XG4gIH0gZWxzZSB7XG4gICAgeSArPSBoTWFyZ2luO1xuICB9XG5cbiAgaWYgKHggKyBoV2lkdGggPiB3aWR0aCkge1xuICAgIHggLT0gaFdpZHRoO1xuICAgIHggLT0gaE1hcmdpbjtcbiAgfSBlbHNlIHtcbiAgICB4ICs9IGhNYXJnaW47XG4gIH1cblxuICBjb25zb2xlLmxvZyhoaWdobGlnaHROb2RlLCB4LCB5KTtcbiAgaGlnaGxpZ2h0Q29udGFpbmVyLnN0eWxlKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7eH1weCwgJHt5fXB4KWApO1xufVxuXG5mdW5jdGlvbiByZW5kZXJMZWdlbmQoKSB7XG4gIC8qKiBMZWdlbmQgKi9cbiAgY29uc3QgbGVnZW5kQ29udGFpbmVyID0gcm9vdENvbnRhaW5lci5zZWxlY3QoJy5sZWdlbmQnKS5lbXB0eSgpXG4gICAgPyByb290Q29udGFpbmVyLmFwcGVuZCgnZGl2JykuYXR0cignY2xhc3MnLCAnbGVnZW5kJylcbiAgICA6IHJvb3RDb250YWluZXIuc2VsZWN0KCcubGVnZW5kJyk7XG5cbiAgY29uc3QgbGVnZW5kQmluZGluZyA9IGxlZ2VuZENvbnRhaW5lclxuICAgIC5zZWxlY3RBbGwoJy5sZWdlbmQtaXRlbScpXG4gICAgLmRhdGEoY29sb3JTY2FsZS5kb21haW4oKSk7XG4gIGxlZ2VuZEJpbmRpbmcuZXhpdCgpLnJlbW92ZSgpO1xuICBjb25zdCBsZWdlbmRFbnRlcmluZyA9IGxlZ2VuZEJpbmRpbmdcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3NwYW4nKVxuICAgIC5hdHRyKCdjbGFzcycsICdsZWdlbmQtaXRlbScpXG4gICAgLmh0bWwoJyB0ZXNzc3NzdCcpO1xuICBsZWdlbmRFbnRlcmluZ1xuICAgIC5tZXJnZShsZWdlbmRCaW5kaW5nKVxuICAgIC5odG1sKFxuICAgICAgZCA9PlxuICAgICAgICBgPHNwYW4gY2xhc3M9J2xlZ2VuZC1zd2F0Y2gnIHN0eWxlPSdiYWNrZ3JvdW5kOiAke2NvbG9yU2NhbGUoXG4gICAgICAgICAgZFxuICAgICAgICApfSc+PC9zcGFuPjxzcGFuIGNsYXNzPSdsZWdlbmQtaXRlbS1sYWJlbCc+JHtkfTwvc3Bhbj4gYFxuICAgICk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlclRyZWUoKSB7XG4gIGNvbnNvbGUubG9nKCdyZW5kZXIgc3ZnIHdpdGggcm9vdE5vZGUnLCByb290Tm9kZSk7XG4gIC8vIHJvb3RDb250YWluZXIuc2VsZWN0KCdzdmcnKS5yZW1vdmUoKTtcbiAgY29uc3Qgbm9kZXMgPSByb290Tm9kZSA/IHJvb3ROb2RlLmRlc2NlbmRhbnRzKCkgOiBbXTtcbiAgY29uc3QgbGlua3MgPSByb290Tm9kZSA/IHJvb3ROb2RlLmxpbmtzKCkgOiBbXTtcbiAgY29uc29sZS5sb2coJ3JlbmRlciBzdmcgd2l0aCBub2RlcycsIG5vZGVzKTtcbiAgY29uc29sZS5sb2coJ3JlbmRlciBzdmcgd2l0aCBsaW5rcycsIGxpbmtzKTtcblxuICAvLyBpbml0aWFsaXplIG1haW4gU1ZHXG4gIGNvbnN0IHN2ZyA9IHJvb3RDb250YWluZXIuc2VsZWN0KCdzdmcnKS5lbXB0eSgpXG4gICAgPyByb290Q29udGFpbmVyXG4gICAgICAgIC5zZWxlY3QoJy52aXMtY29udGFpbmVyJylcbiAgICAgICAgLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpXG4gICAgOiByb290Q29udGFpbmVyLnNlbGVjdCgnc3ZnJyk7XG5cbiAgLy8gdGhlIG1haW4gPGc+IHdoZXJlIGFsbCB0aGUgY2hhcnQgY29udGVudCBnb2VzIGluc2lkZVxuICBjb25zdCBnID0gc3ZnLnNlbGVjdCgnLnJvb3QtZycpLmVtcHR5KClcbiAgICA/IHN2Z1xuICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ3Jvb3QtZycpXG4gICAgICAgIC5hdHRyKFxuICAgICAgICAgICd0cmFuc2Zvcm0nLFxuICAgICAgICAgICd0cmFuc2xhdGUoJyArIHBhZGRpbmcubGVmdCArICcgJyArIHBhZGRpbmcudG9wICsgJyknXG4gICAgICAgIClcbiAgICA6IHN2Zy5zZWxlY3QoJy5yb290LWcnKTtcblxuICBjb25zdCBnTGlua3MgPSBnLnNlbGVjdCgnLmxpbmtzJykuZW1wdHkoKVxuICAgID8gZy5hcHBlbmQoJ2cnKS5hdHRyKCdjbGFzcycsICdsaW5rcycpXG4gICAgOiBnLnNlbGVjdCgnLmxpbmtzJyk7XG4gIGNvbnN0IGdOb2RlcyA9IGcuc2VsZWN0KCcubm9kZXMnKS5lbXB0eSgpXG4gICAgPyBnLmFwcGVuZCgnZycpLmF0dHIoJ2NsYXNzJywgJ25vZGVzJylcbiAgICA6IGcuc2VsZWN0KCcubm9kZXMnKTtcblxuICAvLyBjb25zdCBoaWdobGlnaHRMYWJlbCA9IGcuc2VsZWN0KCcuaGlnaGxpZ2h0LWxhYmVsJykuZW1wdHkoKVxuICAvLyAgID8gZ1xuICAvLyAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgLy8gICAgICAgLmF0dHIoJ2NsYXNzJywgJ2hpZ2hsaWdodC1sYWJlbCcpXG4gIC8vICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAvLyAgICAgICAuYXR0cignZHknLCBwb2ludFJhZGl1cyArIDE4KVxuICAvLyAgICAgICAuc3R5bGUoJ2ZvbnQtd2VpZ2h0JywgJzYwMCcpXG4gIC8vICAgICAgIC5zdHlsZSgncG9pbnRlci1ldmVudHMnLCAnbm9uZScpXG4gIC8vICAgOiBnLnNlbGVjdCgnLmhpZ2hsaWdodC1sYWJlbCcpO1xuXG4gIC8vIHJlbmRlciBub2Rlc1xuICBjb25zdCBub2Rlc0JpbmRpbmcgPSBnTm9kZXMuc2VsZWN0QWxsKCcubm9kZScpLmRhdGEobm9kZXMsIGQgPT4gZFtpZEtleV0pO1xuICBub2Rlc0JpbmRpbmcuZXhpdCgpLnJlbW92ZSgpO1xuICBjb25zdCBub2Rlc0VudGVyID0gbm9kZXNCaW5kaW5nXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdjaXJjbGUnKVxuICAgIC5hdHRyKCdjbGFzcycsICdub2RlJylcbiAgICAuYXR0cigncicsIHBvaW50UmFkaXVzKVxuICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBkID0+IGB0cmFuc2xhdGUoJHtkLnh9ICR7ZC55fSlgKVxuICAgIC5vbignbW91c2VlbnRlcicsIGZ1bmN0aW9uKGQpIHtcbiAgICAgIC8vIGhpZ2hsaWdodExhYmVsXG4gICAgICAvLyAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7ZC54fSAke2QueX0pYClcbiAgICAgIC8vICAgLnRleHQoSlNPTi5zdHJpbmdpZnkoZC5kYXRhKSk7XG4gICAgICBoaWdobGlnaHROb2RlID0gZDtcbiAgICAgIHJlbmRlckhpZ2hsaWdodCgpO1xuICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoJ2hpZ2hsaWdodGVkJywgdHJ1ZSk7XG4gICAgfSlcbiAgICAub24oJ21vdXNlbGVhdmUnLCBmdW5jdGlvbigpIHtcbiAgICAgIC8vIGhpZ2hsaWdodExhYmVsLnRleHQoJycpO1xuICAgICAgaGlnaGxpZ2h0Tm9kZSA9IG51bGw7XG4gICAgICByZW5kZXJIaWdobGlnaHQoKTtcbiAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkKCdoaWdobGlnaHRlZCcsIGZhbHNlKTtcbiAgICB9KTtcblxuICBub2Rlc0VudGVyXG4gICAgLm1lcmdlKG5vZGVzQmluZGluZylcbiAgICAuY2xhc3NlZCgnc3BlY2lhbCcsIGQgPT4gaXNTcGVjaWFsKGQuZGF0YSkpXG4gICAgLmF0dHIoXG4gICAgICAncicsXG4gICAgICBkID0+IChpc1NwZWNpYWwoZC5kYXRhKSA/IHNwZWNpYWxTaXplRmFjdG9yICogcG9pbnRSYWRpdXMgOiBwb2ludFJhZGl1cylcbiAgICApXG4gICAgLmF0dHIoJ3RyYW5zZm9ybScsIGQgPT4gYHRyYW5zbGF0ZSgke2QueH0gJHtkLnl9KWApXG4gICAgLnN0eWxlKCdmaWxsJywgZCA9PiBjb2xvclNjYWxlKGQuZGF0YVtjb2xvcktleV0pKTtcblxuICAvLyByZW5kZXIgbGlua3NcbiAgY29uc3QgbGlua3NCaW5kaW5nID0gZ0xpbmtzXG4gICAgLnNlbGVjdEFsbCgnLmxpbmsnKVxuICAgIC5kYXRhKGxpbmtzLCBkID0+IGAke2Quc291cmNlW2lkS2V5XX0tLSR7ZC50YXJnZXRbaWRLZXldfWApO1xuICBsaW5rc0JpbmRpbmcuZXhpdCgpLnJlbW92ZSgpO1xuXG4gIGNvbnN0IGxpbmtzRW50ZXIgPSBsaW5rc0JpbmRpbmdcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ2xpbmUnKVxuICAgIC5hdHRyKCdjbGFzcycsICdsaW5rJylcbiAgICAuYXR0cigneDEnLCBkID0+IGQuc291cmNlLngpXG4gICAgLmF0dHIoJ3kxJywgZCA9PiBkLnNvdXJjZS55KVxuICAgIC5hdHRyKCd4MicsIGQgPT4gZC50YXJnZXQueClcbiAgICAuYXR0cigneTInLCBkID0+IGQudGFyZ2V0LnkpO1xuXG4gIGxpbmtzRW50ZXJcbiAgICAubWVyZ2UobGlua3NCaW5kaW5nKVxuICAgIC5hdHRyKCd4MScsIGQgPT4gZC5zb3VyY2UueClcbiAgICAuYXR0cigneTEnLCBkID0+IGQuc291cmNlLnkpXG4gICAgLmF0dHIoJ3gyJywgZCA9PiBkLnRhcmdldC54KVxuICAgIC5hdHRyKCd5MicsIGQgPT4gZC50YXJnZXQueSlcbiAgICAuc3R5bGUoJ3N0cm9rZScsIGQgPT4gY29sb3JTY2FsZShkLnRhcmdldC5kYXRhW2NvbG9yS2V5XSkpO1xufVxuXG5mdW5jdGlvbiB0cmVlRnJvbUNzdlRleHRBcmVhKCkge1xuICBjb25zdCB0ZXh0ID0gZDMuc2VsZWN0KCcjY3N2LXRleHQtaW5wdXQnKS5wcm9wZXJ0eSgndmFsdWUnKTtcbiAgY3N2RGF0YSA9IGQzLmNzdlBhcnNlKHRleHQpO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qgc3RyYXRpZmllciA9IGQzXG4gICAgICAuc3RyYXRpZnkoKVxuICAgICAgLmlkKGQgPT4gZFtpZEtleV0pXG4gICAgICAucGFyZW50SWQoZCA9PiBkW3BhcmVudEtleV0pO1xuICAgIHJvb3ROb2RlID0gc3RyYXRpZmllcihjc3ZEYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGFsZXJ0KCdFcnJvciBvY2N1cnJlZCBtYWtpbmcgdHJlZTogJyArIGUpO1xuICB9XG5cbiAgLy8gcnVuIHRyZWUgbGF5b3V0XG4gIGNvbnN0IHRyZWUgPSBkMy50cmVlKCkuc2l6ZShbcGxvdEFyZWFXaWR0aCwgcGxvdEFyZWFIZWlnaHRdKTtcbiAgdHJlZShyb290Tm9kZSk7XG5cbiAgY29uc29sZS5sb2coJ2dvdCBjc3ZEYXRhID0nLCBjc3ZEYXRhKTtcbiAgY29uc29sZS5sb2coJ2dvdCByb290Tm9kZSA9Jywgcm9vdE5vZGUpO1xuICBjb25zb2xlLmxvZyhpZEtleSk7XG5cbiAgLy8gdXBkYXRlIHRoZSBjb2x1bW4gc2VsZWN0c1xuICBkM1xuICAgIC5zZWxlY3QoJyNpZC1rZXktc2VsZWN0JylcbiAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgaWRLZXkgPSB0aGlzLnZhbHVlO1xuICAgICAgdHJlZUZyb21Dc3ZUZXh0QXJlYSgpO1xuICAgICAgcmVuZGVyKCk7XG4gICAgfSlcbiAgICAuc2VsZWN0QWxsKCdvcHRpb24nKVxuICAgIC5kYXRhKGNzdkRhdGEuY29sdW1ucylcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ29wdGlvbicpXG4gICAgLnByb3BlcnR5KCd2YWx1ZScsIGQgPT4gZClcbiAgICAudGV4dChkID0+IGQpO1xuICBkMy5zZWxlY3QoJyNpZC1rZXktc2VsZWN0JykucHJvcGVydHkoJ3ZhbHVlJywgaWRLZXkpO1xuXG4gIGQzXG4gICAgLnNlbGVjdCgnI3BhcmVudC1rZXktc2VsZWN0JylcbiAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgcGFyZW50S2V5ID0gdGhpcy52YWx1ZTtcbiAgICAgIHRyZWVGcm9tQ3N2VGV4dEFyZWEoKTtcbiAgICAgIHJlbmRlcigpO1xuICAgIH0pXG4gICAgLnNlbGVjdEFsbCgnb3B0aW9uJylcbiAgICAuZGF0YShjc3ZEYXRhLmNvbHVtbnMpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdvcHRpb24nKVxuICAgIC5wcm9wZXJ0eSgndmFsdWUnLCBkID0+IGQpXG4gICAgLnRleHQoZCA9PiBkKTtcbiAgZDMuc2VsZWN0KCcjcGFyZW50LWtleS1zZWxlY3QnKS5wcm9wZXJ0eSgndmFsdWUnLCBwYXJlbnRLZXkpO1xuXG4gIGQzXG4gICAgLnNlbGVjdCgnI2NvbG9yLWtleS1zZWxlY3QnKVxuICAgIC5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgICBjb2xvcktleSA9IHRoaXMudmFsdWU7XG4gICAgICB0cmVlRnJvbUNzdlRleHRBcmVhKCk7XG4gICAgICByZW5kZXIoKTtcbiAgICB9KVxuICAgIC5zZWxlY3RBbGwoJ29wdGlvbicpXG4gICAgLmRhdGEoY3N2RGF0YS5jb2x1bW5zKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgnb3B0aW9uJylcbiAgICAucHJvcGVydHkoJ3ZhbHVlJywgZCA9PiBkKVxuICAgIC50ZXh0KGQgPT4gZCk7XG4gIGQzLnNlbGVjdCgnI2NvbG9yLWtleS1zZWxlY3QnKS5wcm9wZXJ0eSgndmFsdWUnLCBjb2xvcktleSk7XG5cbiAgZDNcbiAgICAuc2VsZWN0KCcjc3BlY2lhbC1rZXktc2VsZWN0JylcbiAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgc3BlY2lhbEtleSA9IHRoaXMudmFsdWU7XG4gICAgICB0cmVlRnJvbUNzdlRleHRBcmVhKCk7XG4gICAgICByZW5kZXIoKTtcbiAgICB9KVxuICAgIC5zZWxlY3RBbGwoJ29wdGlvbicpXG4gICAgLmRhdGEoY3N2RGF0YS5jb2x1bW5zKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgnb3B0aW9uJylcbiAgICAucHJvcGVydHkoJ3ZhbHVlJywgZCA9PiBkKVxuICAgIC50ZXh0KGQgPT4gZCk7XG4gIGQzLnNlbGVjdCgnI3NwZWNpYWwta2V5LXNlbGVjdCcpLnByb3BlcnR5KCd2YWx1ZScsIHNwZWNpYWxLZXkpO1xuXG4gIGNvbnN0IGNvbG9yRG9tYWluID0gcm9vdE5vZGVcbiAgICAuZGVzY2VuZGFudHMoKVxuICAgIC5tYXAoZCA9PiBkLmRhdGFbY29sb3JLZXldKVxuICAgIC5maWx0ZXIoKGQsIGksIGEpID0+IGEuaW5kZXhPZihkKSA9PT0gaSlcbiAgICAuc29ydCgpO1xuICBjb2xvclNjYWxlID0gZDMuc2NhbGVPcmRpbmFsKGQzLnNjaGVtZVNldDEpLmRvbWFpbihjb2xvckRvbWFpbik7XG4gIGNvbnNvbGUubG9nKCdjb2xvckRvbWFpbicsIGNvbG9yRG9tYWluKTtcbiAgY29uc29sZS5sb2coJ2NvbG9yU2NhbGUnLCBjb2xvclNjYWxlKTtcbn1cblxudHJlZUZyb21Dc3ZUZXh0QXJlYSgpO1xucmVuZGVyKCk7XG4iXSwibmFtZXMiOlsibGV0IiwiY29uc3QiXSwibWFwcGluZ3MiOiJBQUFBQSxHQUFHLENBQUMsT0FBTyxDQUFDO0FBQ1pBLEdBQUcsQ0FBQyxRQUFRLENBQUM7QUFDYkEsR0FBRyxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUM7QUFDckJBLEdBQUcsQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO0FBQ3pCQSxHQUFHLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQztBQUN6QkEsR0FBRyxDQUFDLFVBQVUsR0FBRyxlQUFlLENBQUM7QUFDakNDLEdBQUssQ0FBQyxpQkFBaUIsR0FBRyxHQUFHLENBQUM7QUFDOUJELEdBQUcsQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDO0FBQ25DQSxHQUFHLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQzs7QUFFekJDLEdBQUssQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNO0dBQ3ZDLFNBQVMsQ0FBQyxDQUFDLENBQUM7R0FDWixLQUFLLENBQUMsR0FBRyxDQUFDO0dBQ1YsTUFBTSxXQUFDLEVBQUMsQ0FBQyxTQUFHLENBQUMsS0FBSyxLQUFFLENBQUM7R0FDckIsTUFBTSxVQUFDLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxBQUFHO0lBQ3pCQSxHQUFLLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDL0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1QixPQUFPLE1BQU0sQ0FBQztHQUNmLEVBQUUsRUFBRSxDQUFDLENBQUM7O0FBRVRBLEdBQUssQ0FBQyxLQUFLLEdBQUcsV0FBVyxDQUFDLEtBQUssR0FBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDO0FBQzNEQSxHQUFLLENBQUMsTUFBTSxHQUFHLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQzs7O0FBRzlEQSxHQUFLLENBQUMsT0FBTyxHQUFHO0VBQ2QsR0FBRyxFQUFFLEVBQUU7RUFDUCxLQUFLLEVBQUUsRUFBRTtFQUNULE1BQU0sRUFBRSxFQUFFO0VBQ1YsSUFBSSxFQUFFLEVBQUU7Q0FDVCxDQUFDOzs7QUFHRkEsR0FBSyxDQUFDLGFBQWEsR0FBRyxLQUFLLEdBQUcsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBQzNEQSxHQUFLLENBQUMsY0FBYyxHQUFHLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7OztBQUc3REEsR0FBSyxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUM7OztBQUd0QkEsR0FBSyxDQUFDLGFBQWEsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUV6QyxTQUFTLE1BQU0sR0FBRztFQUNoQixjQUFjLEVBQUUsQ0FBQztFQUNqQixZQUFZLEVBQUUsQ0FBQztFQUNmLFVBQVUsRUFBRSxDQUFDO0VBQ2IsZUFBZSxFQUFFLENBQUM7Q0FDbkI7O0FBRUQsU0FBUyxjQUFjLEdBQUc7RUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0VBQy9CLEVBQUUsQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sV0FBRSxHQUFHLEFBQUc7SUFDM0MsbUJBQW1CLEVBQUUsQ0FBQztJQUN0QixNQUFNLEVBQUUsQ0FBQztHQUNWLENBQUMsQ0FBQztDQUNKOztBQUVELFNBQVMsU0FBUyxDQUFDLENBQUMsRUFBRTtFQUNwQixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEdBQUcsQ0FBQztDQUNqRDs7QUFFRCxTQUFTLGVBQWUsR0FBRztFQUN6QkEsR0FBSyxDQUFDLGtCQUFrQixHQUFHLGFBQWE7S0FDckMsTUFBTSxDQUFDLHNCQUFzQixDQUFDO0tBQzlCLEtBQUssRUFBRTtNQUNOLGFBQWE7U0FDVixNQUFNLENBQUMsZ0JBQWdCLENBQUM7U0FDeEIsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNiLElBQUksQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUM7TUFDdkMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDOztFQUVqRCxJQUFJLENBQUMsYUFBYSxFQUFFO0lBQ2xCLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDNUMsT0FBTztHQUNSO0VBQ0QsQUFBUSw4QkFBdUI7RUFDL0JBLEdBQUssQ0FBQyxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztLQUN2QyxHQUFHO2dCQUNGLElBQUcsQ0FBQyxTQUNGLDBCQUF1QixHQUFHLGdDQUEwQixJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUcsR0FBRztRQUNuRSxRQUFRO1lBQ0oscURBQWlELFVBQVU7Y0FDekQsSUFBSSxDQUFDLEdBQUcsQ0FBQztjQUNWLGVBQVc7WUFDWixHQUFFLG1CQUFZO0tBQ3JCO0tBQ0EsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDOztFQUVaLGtCQUFrQjtLQUNmLEtBQUssQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDO0tBQ3BCLElBQUk7TUFDSCx1Q0FBb0MsZ0JBQWdCLHNCQUFrQjtLQUN2RSxDQUFDOztFQUVKLE9BR0MsR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxxQkFBcUI7RUFGMUM7RUFDQyx5QkFDNEM7O0VBRXRELEFBQU07RUFBRyx3QkFBb0I7RUFDN0IsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUM7RUFDbEIsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUM7RUFDakJBLEdBQUssQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDOztFQUVsQixJQUFJLENBQUMsR0FBRyxPQUFPLEdBQUcsTUFBTSxFQUFFO0lBQ3hCLENBQUMsSUFBSSxPQUFPLENBQUM7SUFDYixDQUFDLElBQUksT0FBTyxDQUFDO0dBQ2QsTUFBTTtJQUNMLENBQUMsSUFBSSxPQUFPLENBQUM7R0FDZDs7RUFFRCxJQUFJLENBQUMsR0FBRyxNQUFNLEdBQUcsS0FBSyxFQUFFO0lBQ3RCLENBQUMsSUFBSSxNQUFNLENBQUM7SUFDWixDQUFDLElBQUksT0FBTyxDQUFDO0dBQ2QsTUFBTTtJQUNMLENBQUMsSUFBSSxPQUFPLENBQUM7R0FDZDs7RUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7RUFDakMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxnQkFBYSxDQUFDLFlBQU8sQ0FBQyxTQUFLLENBQUMsQ0FBQztDQUNwRTs7QUFFRCxTQUFTLFlBQVksR0FBRzs7RUFFdEJBLEdBQUssQ0FBQyxlQUFlLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUU7TUFDM0QsYUFBYSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQztNQUNuRCxhQUFhLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDOztFQUVwQ0EsR0FBSyxDQUFDLGFBQWEsR0FBRyxlQUFlO0tBQ2xDLFNBQVMsQ0FBQyxjQUFjLENBQUM7S0FDekIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0VBQzdCLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztFQUM5QkEsR0FBSyxDQUFDLGNBQWMsR0FBRyxhQUFhO0tBQ2pDLEtBQUssRUFBRTtLQUNQLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQztLQUM1QixJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7RUFDckIsY0FBYztLQUNYLEtBQUssQ0FBQyxhQUFhLENBQUM7S0FDcEIsSUFBSTtnQkFDSCxFQUFDLENBQUMsU0FDQSxzREFBa0QsVUFBVTtVQUMxRCxDQUFDO1VBQ0YsaURBQTRDLENBQUMsaUJBQVU7S0FDM0QsQ0FBQztDQUNMOztBQUVELFNBQVMsVUFBVSxHQUFHO0VBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLEVBQUUsUUFBUSxDQUFDLENBQUM7O0VBRWxEQSxHQUFLLENBQUMsS0FBSyxHQUFHLFFBQVEsR0FBRyxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDO0VBQ3JEQSxHQUFLLENBQUMsS0FBSyxHQUFHLFFBQVEsR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDO0VBQy9DLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLENBQUM7RUFDNUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQzs7O0VBRzVDQSxHQUFLLENBQUMsR0FBRyxHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxFQUFFO01BQzNDLGFBQWE7U0FDVixNQUFNLENBQUMsZ0JBQWdCLENBQUM7U0FDeEIsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNiLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDO1NBQ3BCLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDO01BQ3pCLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7OztFQUdoQ0EsR0FBSyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEtBQUssRUFBRTtNQUNuQyxHQUFHO1NBQ0EsTUFBTSxDQUFDLEdBQUcsQ0FBQztTQUNYLElBQUksQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDO1NBQ3ZCLElBQUk7VUFDSCxXQUFXO1VBQ1gsWUFBWSxHQUFHLE9BQU8sQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLEdBQUcsR0FBRztTQUN0RDtNQUNILEdBQUcsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7O0VBRTFCQSxHQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSyxFQUFFO01BQ3JDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUM7TUFDcEMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztFQUN2QkEsR0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssRUFBRTtNQUNyQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDO01BQ3BDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7Ozs7Ozs7Ozs7Ozs7RUFhdkJBLEdBQUssQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxZQUFFLEVBQUMsQ0FBQyxTQUFHLENBQUMsQ0FBQyxLQUFLLElBQUMsQ0FBQyxDQUFDO0VBQzFFLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztFQUM3QkEsR0FBSyxDQUFDLFVBQVUsR0FBRyxZQUFZO0tBQzVCLEtBQUssRUFBRTtLQUNQLE1BQU0sQ0FBQyxRQUFRLENBQUM7S0FDaEIsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUM7S0FDckIsSUFBSSxDQUFDLEdBQUcsRUFBRSxXQUFXLENBQUM7S0FDdEIsSUFBSSxDQUFDLFdBQVcsWUFBRSxFQUFDLENBQUMsU0FBRyxpQkFBYSxDQUFDLENBQUMsRUFBQyxVQUFJLENBQUMsQ0FBQyxFQUFDLFVBQUcsQ0FBQztLQUNsRCxFQUFFLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxFQUFFOzs7O01BSTVCLGFBQWEsR0FBRyxDQUFDLENBQUM7TUFDbEIsZUFBZSxFQUFFLENBQUM7TUFDbEIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzlDLENBQUM7S0FDRCxFQUFFLENBQUMsWUFBWSxFQUFFLFdBQVc7O01BRTNCLGFBQWEsR0FBRyxJQUFJLENBQUM7TUFDckIsZUFBZSxFQUFFLENBQUM7TUFDbEIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO0tBQy9DLENBQUMsQ0FBQzs7RUFFTCxVQUFVO0tBQ1AsS0FBSyxDQUFDLFlBQVksQ0FBQztLQUNuQixPQUFPLENBQUMsU0FBUyxZQUFFLEVBQUMsQ0FBQyxTQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFDLENBQUM7S0FDMUMsSUFBSTtNQUNILEdBQUc7Z0JBQ0gsRUFBQyxDQUFDLFNBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLGlCQUFpQixHQUFHLFdBQVcsR0FBRyxXQUFXLElBQUM7S0FDekU7S0FDQSxJQUFJLENBQUMsV0FBVyxZQUFFLEVBQUMsQ0FBQyxTQUFHLGlCQUFhLENBQUMsQ0FBQyxFQUFDLFVBQUksQ0FBQyxDQUFDLEVBQUMsVUFBRyxDQUFDO0tBQ2xELEtBQUssQ0FBQyxNQUFNLFlBQUUsRUFBQyxDQUFDLFNBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUMsQ0FBQyxDQUFDOzs7RUFHcERBLEdBQUssQ0FBQyxZQUFZLEdBQUcsTUFBTTtLQUN4QixTQUFTLENBQUMsT0FBTyxDQUFDO0tBQ2xCLElBQUksQ0FBQyxLQUFLLFlBQUUsRUFBQyxDQUFDLFdBQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUMsV0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFFLENBQUMsQ0FBQztFQUM5RCxZQUFZLENBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUM7O0VBRTdCQSxHQUFLLENBQUMsVUFBVSxHQUFHLFlBQVk7S0FDNUIsS0FBSyxFQUFFO0tBQ1AsTUFBTSxDQUFDLE1BQU0sQ0FBQztLQUNkLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDO0tBQ3JCLElBQUksQ0FBQyxJQUFJLFlBQUUsRUFBQyxDQUFDLFNBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFDLENBQUM7S0FDM0IsSUFBSSxDQUFDLElBQUksWUFBRSxFQUFDLENBQUMsU0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUMsQ0FBQztLQUMzQixJQUFJLENBQUMsSUFBSSxZQUFFLEVBQUMsQ0FBQyxTQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBQyxDQUFDO0tBQzNCLElBQUksQ0FBQyxJQUFJLFlBQUUsRUFBQyxDQUFDLFNBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFDLENBQUMsQ0FBQzs7RUFFL0IsVUFBVTtLQUNQLEtBQUssQ0FBQyxZQUFZLENBQUM7S0FDbkIsSUFBSSxDQUFDLElBQUksWUFBRSxFQUFDLENBQUMsU0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUMsQ0FBQztLQUMzQixJQUFJLENBQUMsSUFBSSxZQUFFLEVBQUMsQ0FBQyxTQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBQyxDQUFDO0tBQzNCLElBQUksQ0FBQyxJQUFJLFlBQUUsRUFBQyxDQUFDLFNBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFDLENBQUM7S0FDM0IsSUFBSSxDQUFDLElBQUksWUFBRSxFQUFDLENBQUMsU0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUMsQ0FBQztLQUMzQixLQUFLLENBQUMsUUFBUSxZQUFFLEVBQUMsQ0FBQyxTQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBQyxDQUFDLENBQUM7Q0FDOUQ7O0FBRUQsU0FBUyxtQkFBbUIsR0FBRztFQUM3QkEsR0FBSyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0VBQzVELE9BQU8sR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDOztFQUU1QixJQUFJO0lBQ0ZBLEdBQUssQ0FBQyxVQUFVLEdBQUcsRUFBRTtPQUNsQixRQUFRLEVBQUU7T0FDVixFQUFFLFdBQUMsRUFBQyxDQUFDLFNBQUcsQ0FBQyxDQUFDLEtBQUssSUFBQyxDQUFDO09BQ2pCLFFBQVEsV0FBQyxFQUFDLENBQUMsU0FBRyxDQUFDLENBQUMsU0FBUyxJQUFDLENBQUMsQ0FBQztJQUMvQixRQUFRLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0dBQ2hDLENBQUMsT0FBTyxDQUFDLEVBQUU7SUFDVixLQUFLLENBQUMsOEJBQThCLEdBQUcsQ0FBQyxDQUFDLENBQUM7R0FDM0M7OztFQUdEQSxHQUFLLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxhQUFhLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQztFQUM3RCxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7O0VBRWYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsT0FBTyxDQUFDLENBQUM7RUFDdEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxRQUFRLENBQUMsQ0FBQztFQUN4QyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDOzs7RUFHbkIsRUFBRTtLQUNDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQztLQUN4QixFQUFFLENBQUMsUUFBUSxFQUFFLFdBQVc7TUFDdkIsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7TUFDbkIsbUJBQW1CLEVBQUUsQ0FBQztNQUN0QixNQUFNLEVBQUUsQ0FBQztLQUNWLENBQUM7S0FDRCxTQUFTLENBQUMsUUFBUSxDQUFDO0tBQ25CLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO0tBQ3JCLEtBQUssRUFBRTtLQUNQLE1BQU0sQ0FBQyxRQUFRLENBQUM7S0FDaEIsUUFBUSxDQUFDLE9BQU8sWUFBRSxFQUFDLENBQUMsU0FBRyxJQUFDLENBQUM7S0FDekIsSUFBSSxXQUFDLEVBQUMsQ0FBQyxTQUFHLElBQUMsQ0FBQyxDQUFDO0VBQ2hCLEVBQUUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDOztFQUVyRCxFQUFFO0tBQ0MsTUFBTSxDQUFDLG9CQUFvQixDQUFDO0tBQzVCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsV0FBVztNQUN2QixTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztNQUN2QixtQkFBbUIsRUFBRSxDQUFDO01BQ3RCLE1BQU0sRUFBRSxDQUFDO0tBQ1YsQ0FBQztLQUNELFNBQVMsQ0FBQyxRQUFRLENBQUM7S0FDbkIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7S0FDckIsS0FBSyxFQUFFO0tBQ1AsTUFBTSxDQUFDLFFBQVEsQ0FBQztLQUNoQixRQUFRLENBQUMsT0FBTyxZQUFFLEVBQUMsQ0FBQyxTQUFHLElBQUMsQ0FBQztLQUN6QixJQUFJLFdBQUMsRUFBQyxDQUFDLFNBQUcsSUFBQyxDQUFDLENBQUM7RUFDaEIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7O0VBRTdELEVBQUU7S0FDQyxNQUFNLENBQUMsbUJBQW1CLENBQUM7S0FDM0IsRUFBRSxDQUFDLFFBQVEsRUFBRSxXQUFXO01BQ3ZCLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO01BQ3RCLG1CQUFtQixFQUFFLENBQUM7TUFDdEIsTUFBTSxFQUFFLENBQUM7S0FDVixDQUFDO0tBQ0QsU0FBUyxDQUFDLFFBQVEsQ0FBQztLQUNuQixJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztLQUNyQixLQUFLLEVBQUU7S0FDUCxNQUFNLENBQUMsUUFBUSxDQUFDO0tBQ2hCLFFBQVEsQ0FBQyxPQUFPLFlBQUUsRUFBQyxDQUFDLFNBQUcsSUFBQyxDQUFDO0tBQ3pCLElBQUksV0FBQyxFQUFDLENBQUMsU0FBRyxJQUFDLENBQUMsQ0FBQztFQUNoQixFQUFFLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQzs7RUFFM0QsRUFBRTtLQUNDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQztLQUM3QixFQUFFLENBQUMsUUFBUSxFQUFFLFdBQVc7TUFDdkIsVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7TUFDeEIsbUJBQW1CLEVBQUUsQ0FBQztNQUN0QixNQUFNLEVBQUUsQ0FBQztLQUNWLENBQUM7S0FDRCxTQUFTLENBQUMsUUFBUSxDQUFDO0tBQ25CLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO0tBQ3JCLEtBQUssRUFBRTtLQUNQLE1BQU0sQ0FBQyxRQUFRLENBQUM7S0FDaEIsUUFBUSxDQUFDLE9BQU8sWUFBRSxFQUFDLENBQUMsU0FBRyxJQUFDLENBQUM7S0FDekIsSUFBSSxXQUFDLEVBQUMsQ0FBQyxTQUFHLElBQUMsQ0FBQyxDQUFDO0VBQ2hCLEVBQUUsQ0FBQyxNQUFNLENBQUMscUJBQXFCLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDOztFQUUvREEsR0FBSyxDQUFDLFdBQVcsR0FBRyxRQUFRO0tBQ3pCLFdBQVcsRUFBRTtLQUNiLEdBQUcsV0FBQyxFQUFDLENBQUMsU0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBQyxDQUFDO0tBQzFCLE1BQU0sVUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLFNBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFDLENBQUM7S0FDdkMsSUFBSSxFQUFFLENBQUM7RUFDVixVQUFVLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0VBQ2hFLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0VBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0NBQ3ZDOztBQUVELG1CQUFtQixFQUFFLENBQUM7QUFDdEIsTUFBTSxFQUFFLENBQUM7In0=